

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyRTX.core.analysis_utils &mdash; pyRTX 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=2389946f"></script>
      <script src="../../../_static/doctools.js?v=888ff710"></script>
      <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            pyRTX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#from-source">From Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#tutorial-1-first-steps-with-pyrtx">Tutorial 1: First Steps with pyRTX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/Notebook1.html">Notebook n. 1:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorials/Notebook1.html#Spacecraft-shape-definition">Spacecraft shape definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorials/Notebook1.html#Speeding-up-the-code">Speeding up the code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorials/Notebook1.html#Exporting-the-data">Exporting the data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#tutorial-2-advanced-srp-calculations">Tutorial 2: Advanced SRP Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/Notebook2.html">Solar Radiation Pressure: Various contributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tutorials/Notebook2.html#Effect-of-diffusion">Effect of diffusion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#tutorial-3-lookup-tables">Tutorial 3: Lookup Tables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/Notebook3.html">Lookup Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/Notebook3.html#Computing-the-LUT">Computing the LUT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/index.html#tutorial-4-planetary-radiation">Tutorial 4: Planetary Radiation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tutorials/Notebook4.html">Planetary radiation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/core.html">Core Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#module-pyRTX.core.utils_rt">Ray Tracing Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.get_cached_embree_scene"><code class="docutils literal notranslate"><span class="pre">get_cached_embree_scene()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.chunker"><code class="docutils literal notranslate"><span class="pre">chunker()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.pxform_convert"><code class="docutils literal notranslate"><span class="pre">pxform_convert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.block_normalize"><code class="docutils literal notranslate"><span class="pre">block_normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.block_dot"><code class="docutils literal notranslate"><span class="pre">block_dot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.pixel_plane"><code class="docutils literal notranslate"><span class="pre">pixel_plane()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.fast_vector_build"><code class="docutils literal notranslate"><span class="pre">fast_vector_build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.pixel_plane_opt"><code class="docutils literal notranslate"><span class="pre">pixel_plane_opt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.reflected"><code class="docutils literal notranslate"><span class="pre">reflected()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.get_orthogonal"><code class="docutils literal notranslate"><span class="pre">get_orthogonal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.sample_lambert_dist"><code class="docutils literal notranslate"><span class="pre">sample_lambert_dist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.diffuse"><code class="docutils literal notranslate"><span class="pre">diffuse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.compute_secondary_bounce"><code class="docutils literal notranslate"><span class="pre">compute_secondary_bounce()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.save_for_visualization"><code class="docutils literal notranslate"><span class="pre">save_for_visualization()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.Embree3_init_geometry"><code class="docutils literal notranslate"><span class="pre">Embree3_init_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.Embree3_init_rayhit"><code class="docutils literal notranslate"><span class="pre">Embree3_init_rayhit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.Embree3_dump_solution"><code class="docutils literal notranslate"><span class="pre">Embree3_dump_solution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.cgal_init_geometry"><code class="docutils literal notranslate"><span class="pre">cgal_init_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.get_centroids"><code class="docutils literal notranslate"><span class="pre">get_centroids()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.get_cross_products"><code class="docutils literal notranslate"><span class="pre">get_cross_products()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.get_face_areas"><code class="docutils literal notranslate"><span class="pre">get_face_areas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.get_surface_normals"><code class="docutils literal notranslate"><span class="pre">get_surface_normals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.get_surface_normals_and_face_areas"><code class="docutils literal notranslate"><span class="pre">get_surface_normals_and_face_areas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.ShapeModel"><code class="docutils literal notranslate"><span class="pre">ShapeModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.TrimeshShapeModel"><code class="docutils literal notranslate"><span class="pre">TrimeshShapeModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.CgalTrimeshShapeModel"><code class="docutils literal notranslate"><span class="pre">CgalTrimeshShapeModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.EmbreeTrimeshShapeModel"><code class="docutils literal notranslate"><span class="pre">EmbreeTrimeshShapeModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.utils_rt.RTXkernel"><code class="docutils literal notranslate"><span class="pre">RTXkernel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#module-pyRTX.core.shadow_utils">Shadow Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.shadow_utils.circular_mask"><code class="docutils literal notranslate"><span class="pre">circular_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.shadow_utils.circular_rim"><code class="docutils literal notranslate"><span class="pre">circular_rim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.shadow_utils.compute_directions"><code class="docutils literal notranslate"><span class="pre">compute_directions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.shadow_utils.compute_beta"><code class="docutils literal notranslate"><span class="pre">compute_beta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.shadow_utils.compute_pixel_intensities"><code class="docutils literal notranslate"><span class="pre">compute_pixel_intensities()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#module-pyRTX.core.physical_utils">Physical Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.physical_utils.preprocess_RTX_geometry"><code class="docutils literal notranslate"><span class="pre">preprocess_RTX_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.physical_utils.preprocess_materials"><code class="docutils literal notranslate"><span class="pre">preprocess_materials()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.physical_utils.srp_core"><code class="docutils literal notranslate"><span class="pre">srp_core()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.physical_utils.compute_srp"><code class="docutils literal notranslate"><span class="pre">compute_srp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/core.html#module-pyRTX.core.parallel_utils">Parallel Utilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.parallel_utils.get_ncores"><code class="docutils literal notranslate"><span class="pre">get_ncores()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.parallel_utils.is_method"><code class="docutils literal notranslate"><span class="pre">is_method()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.parallel_utils.get_unwrapped"><code class="docutils literal notranslate"><span class="pre">get_unwrapped()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/core.html#pyRTX.core.parallel_utils.parallel"><code class="docutils literal notranslate"><span class="pre">parallel()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/classes.html">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/classes.html#sunshadow">SunShadow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/classes.html#solarpressure">SolarPressure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/classes.html#pyRTX.classes.SRP.SolarPressure"><code class="docutils literal notranslate"><span class="pre">SolarPressure</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/classes.html#planet">Planet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/classes.html#pyRTX.classes.Planet.Planet"><code class="docutils literal notranslate"><span class="pre">Planet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/classes.html#pixelplane">PixelPlane</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/classes.html#pyRTX.classes.PixelPlane.PixelPlane"><code class="docutils literal notranslate"><span class="pre">PixelPlane</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/classes.html#spacecraft">Spacecraft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/classes.html#pyRTX.classes.Spacecraft.Spacecraft"><code class="docutils literal notranslate"><span class="pre">Spacecraft</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/defaults.html">Default Values and Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/index.html#core-modules">Core Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/generated/pyRTX.core.html">pyRTX.core</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.core.analysis_utils.html">pyRTX.core.analysis_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.core.parallel_utils.html">pyRTX.core.parallel_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.core.physical_utils.html">pyRTX.core.physical_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.core.shadow_utils.html">pyRTX.core.shadow_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.core.utils_rt.html">pyRTX.core.utils_rt</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/index.html#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/generated/pyRTX.classes.html">pyRTX.classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.Atmosphere.html">pyRTX.classes.Atmosphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.Drag.html">pyRTX.classes.Drag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.LookUpTable.html">pyRTX.classes.LookUpTable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.PixelPlane.html">pyRTX.classes.PixelPlane</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.Planet.html">pyRTX.classes.Planet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.Precompute.html">pyRTX.classes.Precompute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.Radiation.html">pyRTX.classes.Radiation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.RayTracer.html">pyRTX.classes.RayTracer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.SRP.html">pyRTX.classes.SRP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/generated/pyRTX.classes.Spacecraft.html">pyRTX.classes.Spacecraft</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyRTX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pyRTX.core.analysis_utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyRTX.core.analysis_utils</h1><div class="highlight"><pre>
<span></span><span class="c1"># Utilities for data/output analysis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">spiceypy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">pyRTX.core.utils_rt</span> <span class="kn">import</span> <span class="n">block_normalize</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">ceil</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A set of utilities mainly focused on result analysis and data manipulation</span>
<span class="sd">&quot;&quot;&quot;</span>






<div class="viewcode-block" id="LookupTable"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTable">[docs]</a><span class="k">class</span> <span class="nc">LookupTable</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	This class is used to store results in the shape aof a lookup table.</span>
<span class="sd">	This is mainly used to store the resultas of a set of raytracing results</span>
<span class="sd">	example: the solar pressure for a body is computed for a grid of RA/DEC values.</span>
<span class="sd">	these values can be stored in the LookupTable object and later retrieved.</span>
<span class="sd">	This class offers the possibility of not oly retrieving pre-computed values, but</span>
<span class="sd">	aslso interpolating between grid points.</span>

<span class="sd">	NOTE: the grid of the lookup table does not need to be regular</span>
<span class="sd">	the interpolation is based on numpy griddata method which is able to cope</span>
<span class="sd">	with unstructured grids</span>

<span class="sd">	The main way of retrieving values is through indexing. The following are implemented:</span>

<span class="sd">	LUT[a,b]: if a, b are in the original lookup table, the original values are returned, otherwise they are interpolated</span>
<span class="sd">	LUT[:,:] or LUT[a:b, c:d]: return the original lut sliced as requested</span>
<span class="sd">	LUT[:,a]: return the original lut (all elements of first axis, integer-indexed elements of second axis)</span>
<span class="sd">	LUT[array-like, array-like]: return the lookup table interpolated in the array-like points</span>



<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	linspace_x : np.array(N,)</span>
<span class="sd">		The x axis of the lookup table</span>
<span class="sd">	linspace_y : np.array(M,)</span>
<span class="sd">		The y axis of the lookup table</span>
<span class="sd">	values : np.ndarray (N,M,1)</span>
<span class="sd">		The lookup table values</span>


<span class="sd">	&quot;&quot;&quot;</span>
<div class="viewcode-block" id="LookupTable.__init__"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTable.__init__">[docs]</a>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linspace_x</span><span class="p">,</span> <span class="n">linspace_y</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">linspace_x</span> <span class="o">=</span> <span class="n">linspace_x</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">linspace_y</span> <span class="o">=</span> <span class="n">linspace_y</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">_set_defaults</span><span class="p">()</span></div>


	<span class="k">def</span> <span class="nf">_set_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">interpType</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span>

	<span class="k">def</span> <span class="nf">_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
		<span class="n">meshgrid_x</span><span class="p">,</span> <span class="n">meshgrid_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linspace_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">linspace_y</span><span class="p">)</span>
		<span class="c1">#return  interpolate.griddata((meshgrid_x.ravel(), meshgrid_y.ravel()), self.values.T.ravel(),np.array([x,y]).T, method = self.interpType)</span>
		<span class="k">return</span>  <span class="n">interpolate</span><span class="o">.</span><span class="n">griddata</span><span class="p">((</span><span class="n">meshgrid_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">meshgrid_y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpType</span><span class="p">)</span>

<div class="viewcode-block" id="LookupTable.set_interpType"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTable.set_interpType">[docs]</a>	<span class="k">def</span> <span class="nf">set_interpType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpType</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">interpType</span> <span class="o">=</span> <span class="n">interpType</span></div>


	<span class="k">def</span> <span class="nf">_get_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">search_list</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">search_list</span> <span class="o">==</span> <span class="n">ind</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

	
<div class="viewcode-block" id="LookupTable.interp_point"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTable.interp_point">[docs]</a>	<span class="k">def</span> <span class="nf">interp_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="LookupTable.__getitem__"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTable.__getitem__">[docs]</a>	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxs</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Implement a getitem method.</span>
<span class="sd">		Several usages are possible:</span>

<span class="sd">		LUT[a,b]: if a, b are in the original lookup table, the original values are returned, otherwise they are interpolated</span>
<span class="sd">		LUT[:,:] or LUT[a:b, c:d]: return the original lut sliced as requested</span>
<span class="sd">		LUT[:,a]: return the original lut (all elements of first axis, integer-indexed elements of second axis)</span>
<span class="sd">		LUT[array-like, array-like]: return the lookup table interpolated in the array-like points</span>

<span class="sd">		&quot;&quot;&quot;</span>

		<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">idxs</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp_point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span></div>
			



<div class="viewcode-block" id="LookupTable.quickPlot"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTable.quickPlot">[docs]</a>	<span class="k">def</span> <span class="nf">quickPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">conversion</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">clabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">saveto</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Produce a quick plot of the lookup table</span>

<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		xlabel : str (Optional)</span>
<span class="sd">			label for the x-axis</span>
<span class="sd">		ylabel : str (Optional)</span>
<span class="sd">			label for the y-axis</span>
<span class="sd">		title : str (Optional)</span>
<span class="sd">			title of the plot</span>
<span class="sd">		conversion : float (Optional, default 1)</span>
<span class="sd">			a conversion factor for the plotted values. This method will plot X*conversion, Y*conversion</span>
<span class="sd">		clabel : str (Optional)</span>
<span class="sd">			label of the color bar</span>
<span class="sd">		cmap : str	(Optional, default &#39;viridis&#39;)</span>
<span class="sd">			the colormap to use (matplotlib colormaps)</span>
<span class="sd">		saveto : str (Optional, default None)</span>
<span class="sd">			if not None: the path to save the plot to (the file extension defines the format)</span>

<span class="sd">		&quot;&quot;&quot;</span>


		<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

		<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linspace_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">linspace_y</span><span class="p">)</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">h</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">conversion</span><span class="p">,</span><span class="n">Y</span><span class="o">*</span><span class="n">conversion</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp_point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linspace_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">linspace_y</span><span class="p">),</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
		<span class="n">c</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">clabel</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">saveto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">saveto</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>



<div class="viewcode-block" id="LookupTableND"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND">[docs]</a><span class="k">class</span> <span class="nc">LookupTableND</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Same concept as the LookupTable class, but allowing for multi-dimensional (&gt;2) tables</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	axes : tuple of np.array</span>
<span class="sd">		The axes of the lookup table</span>
<span class="sd">	values : np.ndarray(N,M,L,...,1)</span>
<span class="sd">	info : str</span>
<span class="sd">		A string field to store information about the lookup table. This is set as a class property</span>
<span class="sd">		so it can be requested trhough instance.info</span>
<span class="sd">	np.array : np.array</span>
<span class="sd">		unset</span>

<span class="sd">	&quot;&quot;&quot;</span>



<div class="viewcode-block" id="LookupTableND.__init__"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND.__init__">[docs]</a>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">np_array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">info</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">np_array</span> <span class="o">=</span> <span class="n">np_array</span>


		<span class="bp">self</span><span class="o">.</span><span class="n">_set_defaults</span><span class="p">()</span></div>


	<span class="k">def</span> <span class="nf">_set_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">interpType</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span>

	<span class="k">def</span> <span class="nf">_interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interpn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span> 


<div class="viewcode-block" id="LookupTableND.set_interpType"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND.set_interpType">[docs]</a>	<span class="k">def</span> <span class="nf">set_interpType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpType</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">interpType</span> <span class="o">=</span> <span class="n">interpType</span></div>


<div class="viewcode-block" id="LookupTableND.get_idx"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND.get_idx">[docs]</a>	<span class="k">def</span> <span class="nf">get_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">search_list</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">search_list</span> <span class="o">==</span> <span class="n">ind</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>

	
<div class="viewcode-block" id="LookupTableND.interp_point"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND.interp_point">[docs]</a>	<span class="k">def</span> <span class="nf">interp_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolator</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span></div>


<div class="viewcode-block" id="LookupTableND.__getitem__"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND.__getitem__">[docs]</a>	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxs</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Implement a getitem method.</span>
<span class="sd">		Several usages are possible:</span>

<span class="sd">		LUT[a,b]: if a, b are in the original lookup table, the original values are returned, otherwise they are interpolated</span>
<span class="sd">		LUT[:,:] or LUT[a:b, c:d]: return the original lut sliced as requested</span>
<span class="sd">		LUT[:,a]: return the original lut (all elements of first axis, integer-indexed elements of second axis)</span>
<span class="sd">		LUT[array-like, array-like]: return the lookup table interpolated in the array-like points</span>

<span class="sd">		&quot;&quot;&quot;</span>

		
		<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">])</span> <span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">idxs</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			
			<span class="n">outval</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">interp_point</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">outval</span><span class="p">)</span></div>
			

<div class="viewcode-block" id="LookupTableND.axisExtent"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND.axisExtent">[docs]</a>	<span class="k">def</span> <span class="nf">axisExtent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">extent</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
			<span class="n">extent</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ax</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ax</span><span class="p">)])</span>
		<span class="k">return</span> <span class="n">extent</span></div>


<div class="viewcode-block" id="LookupTableND.quickPlot"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.LookupTableND.quickPlot">[docs]</a>	<span class="k">def</span> <span class="nf">quickPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">conversion</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">clabel</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">saveto</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Produce a quick plot of the lookup table</span>

<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		xlabel : str (Optional)</span>
<span class="sd">			label for the x-axis</span>
<span class="sd">		ylabel : str (Optional)</span>
<span class="sd">			label for the y-axis</span>
<span class="sd">		title : str (Optional)</span>
<span class="sd">			title of the plot</span>
<span class="sd">		conversion : float (Optional, default 1)</span>
<span class="sd">			a conversion factor for the plotted values. This method will plot X*conversion, Y*conversion</span>
<span class="sd">		clabel : str (Optional)</span>
<span class="sd">			label of the color bar</span>
<span class="sd">		cmap : str	(Optional, default &#39;viridis&#39;)</span>
<span class="sd">			the colormap to use (matplotlib colormaps)</span>
<span class="sd">		saveto : str (Optional, default None)</span>
<span class="sd">			if not None: the path to save the plot to (the file extension defines the format)</span>

<span class="sd">		&quot;&quot;&quot;</span>


		<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

		<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">h</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">conversion</span><span class="p">,</span><span class="n">Y</span><span class="o">*</span><span class="n">conversion</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interp_point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">),</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
		<span class="n">c</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">clabel</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">saveto</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">saveto</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>



<div class="viewcode-block" id="ScatterLookup"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.ScatterLookup">[docs]</a><span class="k">class</span> <span class="nc">ScatterLookup</span><span class="p">():</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	A class for dealing with zone-scattered lookup tables</span>
<span class="sd">	Intended for creating a lookup table of sets of computed values that lie in distinct, DISJUNCT,</span>
<span class="sd">	zones of the axes space.</span>
<span class="sd">	Example: the value of a variable has been computed in X = [0,1] Y = [0,1] and X = [3,4] Y = [-2,-1]</span>

<span class="sd">	After instantiating the empty class, the different zones are added. Example</span>

<span class="sd">	sc = ScatterLookup()</span>
<span class="sd">	zone1 = LookupTableND(*args, **kwargs)</span>
<span class="sd">	zone2 = LookupTableND(*args, **kwargs)</span>
<span class="sd">	sc.addZone(zone1)</span>
<span class="sd">	sc.addZone(zone2)</span>



<span class="sd">	The value retrieval follows the same rules of indexing as the LookupTable and LookupTableND classes</span>
<span class="sd">	&quot;&quot;&quot;</span>
<div class="viewcode-block" id="ScatterLookup.__init__"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.ScatterLookup.__init__">[docs]</a>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">zones</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">zonedef</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="ScatterLookup.add_zone"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.ScatterLookup.add_zone">[docs]</a>	<span class="k">def</span> <span class="nf">add_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ZoneLookup</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Add a zone</span>
<span class="sd">		Parameters</span>
<span class="sd">		----------</span>
<span class="sd">		ZoneLookup : pyRTX.core.analysis_utils.LookupTableND</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ZoneLookup</span><span class="p">,</span> <span class="n">LookupTableND</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The ZoneLookup argument must be of type class.LookupTableND&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">zones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ZoneLookup</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">zonedef</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ZoneLookup</span><span class="o">.</span><span class="n">axisExtent</span><span class="p">())</span></div>

	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxs</span><span class="p">):</span>

		<span class="n">zone_no</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone_determination</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zones</span><span class="p">[</span><span class="n">zone_no</span><span class="p">][</span><span class="n">idxs</span><span class="p">]</span>
		


<div class="viewcode-block" id="ScatterLookup.zone_determination"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.ScatterLookup.zone_determination">[docs]</a>	<span class="k">def</span> <span class="nf">zone_determination</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">idxs</span><span class="p">):</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">zonedef</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonedef</span><span class="p">):</span>
			<span class="c1">#print(f&#39;Zone {zonedef}&#39;)  FOR DEBYG</span>
			<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idxs</span><span class="p">):</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">zonedef</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">idx</span><span class="o">&lt;=</span><span class="n">zonedef</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
					<span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
					<span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">zonedef</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">zonedef</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">i</span> 
			<span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonedef</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Interpolation Error: No data correspond to your request&#39;</span><span class="p">)</span></div></div>




<div class="viewcode-block" id="TiffInterpolator"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.TiffInterpolator">[docs]</a><span class="k">class</span> <span class="nc">TiffInterpolator</span><span class="p">():</span>
<div class="viewcode-block" id="TiffInterpolator.__init__"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.TiffInterpolator.__init__">[docs]</a>	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
		


		<span class="c1"># Error control</span>
		<span class="c1">#if len(self.axes) != len(values.shape[0:-1]):</span>
		<span class="c1">#	raise ValueError(f&#39;The number of axes provided does not match with provided data\n Provided data has shape {len(values.shape)} while {len(self.axes)} axes have been provided&#39;)</span>



		<span class="bp">self</span><span class="o">.</span><span class="n">_set_defaults</span><span class="p">()</span></div>


	<span class="k">def</span> <span class="nf">_set_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">interpType</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span>

<div class="viewcode-block" id="TiffInterpolator.interpolator"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.TiffInterpolator.interpolator">[docs]</a>	<span class="k">def</span> <span class="nf">interpolator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
		
		<span class="k">return</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interpn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span> </div>


<div class="viewcode-block" id="TiffInterpolator.set_interpType"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.TiffInterpolator.set_interpType">[docs]</a>	<span class="k">def</span> <span class="nf">set_interpType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpType</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">interpType</span> <span class="o">=</span> <span class="n">interpType</span></div>


<div class="viewcode-block" id="TiffInterpolator.get_idx"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.TiffInterpolator.get_idx">[docs]</a>	<span class="k">def</span> <span class="nf">get_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">search_list</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">search_list</span> <span class="o">==</span> <span class="n">ind</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>

	
<div class="viewcode-block" id="TiffInterpolator.interp_point"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.TiffInterpolator.interp_point">[docs]</a>	<span class="k">def</span> <span class="nf">interp_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span></div>


<div class="viewcode-block" id="TiffInterpolator.__getitem__"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.TiffInterpolator.__getitem__">[docs]</a>	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxs</span><span class="p">):</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Implement a getitem method.</span>
<span class="sd">		Several usages are possible:</span>

<span class="sd">		LUT[a,b]: if a, b are in the original lookup table, the original values are returned, otherwise they are interpolated</span>
<span class="sd">		LUT[:,:] or LUT[a:b, c:d]: return the original lut sliced as requested</span>
<span class="sd">		LUT[:,a]: return the original lut (all elements of first axis, integer-indexed elements of second axis)</span>
<span class="sd">		LUT[array-like, array-like]: return the lookup table interpolated in the array-like points</span>

<span class="sd">		&quot;&quot;&quot;</span>

		
		<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">idxs</span><span class="p">])</span> <span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">idxs</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			
			<span class="n">outval</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">interp_point</span><span class="p">(</span><span class="n">idxs</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">outval</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="getSunAngles"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.getSunAngles">[docs]</a><span class="k">def</span> <span class="nf">getSunAngles</span><span class="p">(</span><span class="n">scName</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">epoch</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">correction</span> <span class="o">=</span> <span class="s1">&#39;LT+S&#39;</span><span class="p">):</span>
	<span class="n">sunPos</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="s1">&#39;Sun&#39;</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">scFrame</span><span class="p">,</span> <span class="n">correction</span><span class="p">,</span> <span class="n">scName</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
	<span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">recrad</span><span class="p">(</span><span class="n">sunPos</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span></div>

	

<div class="viewcode-block" id="epochRange"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.epochRange">[docs]</a><span class="k">def</span> <span class="nf">epochRange</span><span class="p">(</span><span class="n">startEpoch</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">startEpoch</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
		<span class="n">startEp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">str2et</span><span class="p">(</span><span class="n">startEpoch</span><span class="p">)</span>
	<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">startEpoch</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
		<span class="n">startEp</span> <span class="o">=</span> <span class="n">startEpoch</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;startEpoch argument must be str or float&#39;</span><span class="p">)</span>
	
	<span class="n">endEp</span> <span class="o">=</span> <span class="n">startEp</span> <span class="o">+</span> <span class="n">duration</span>

	<span class="n">epochList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">startEp</span><span class="p">,</span> <span class="n">endEp</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">endEp</span> <span class="o">-</span> <span class="n">startEp</span><span class="p">)</span><span class="o">/</span><span class="n">step</span><span class="p">)),</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">epochList</span></div>


<div class="viewcode-block" id="epochRange2"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.epochRange2">[docs]</a><span class="k">def</span> <span class="nf">epochRange2</span><span class="p">(</span><span class="n">startEpoch</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">endEpoch</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">startEpoch</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
		<span class="n">startEp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">str2et</span><span class="p">(</span><span class="n">startEpoch</span><span class="p">)</span>
	<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">startEpoch</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
		<span class="n">startEp</span> <span class="o">=</span> <span class="n">startEpoch</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;startEpoch argument must be str or float&#39;</span><span class="p">)</span>


	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">endEpoch</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
		<span class="n">endEp</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">str2et</span><span class="p">(</span><span class="n">endEpoch</span><span class="p">)</span>
	<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">endEpoch</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
		<span class="n">endEp</span> <span class="o">=</span> <span class="n">endEpoch</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;endEpoch argument must be str or float&#39;</span><span class="p">)</span>
	
	<span class="n">curr</span> <span class="o">=</span> <span class="n">startEp</span>

	<span class="n">epochlist</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">while</span> <span class="n">curr</span> <span class="o">&lt;=</span> <span class="n">endEp</span><span class="p">:</span>
		<span class="n">epochlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span>
		<span class="n">curr</span> <span class="o">+=</span> <span class="n">step</span>
	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">epochlist</span><span class="p">)</span></div>





<div class="viewcode-block" id="computeRADEC"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.computeRADEC">[docs]</a><span class="k">def</span> <span class="nf">computeRADEC</span><span class="p">(</span><span class="n">vecs</span><span class="p">,</span> <span class="n">periodicity</span> <span class="o">=</span> <span class="mi">360</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	From a ND array of shape (N, 3), compute RA/DEC</span>

<span class="sd">	Parameters:</span>
<span class="sd">	vecs: [ndarray (N,3)]</span>
<span class="sd">	Returns:</span>
<span class="sd">	RA, DEC</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">n</span> <span class="o">=</span> <span class="n">block_normalize</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span>
	<span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">n</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>
	<span class="n">sinB</span> <span class="o">=</span> <span class="n">n</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
	<span class="n">cosB</span> <span class="o">=</span> <span class="n">n</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
	<span class="n">ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">sinB</span><span class="p">,</span> <span class="n">cosB</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">periodicity</span> <span class="o">==</span> <span class="mi">360</span><span class="p">:</span>
		<span class="n">ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ra</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">ra</span><span class="p">,</span> <span class="n">ra</span><span class="p">)</span>



	<span class="k">return</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span></div>





<div class="viewcode-block" id="convertTIFtoMesh"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.convertTIFtoMesh">[docs]</a><span class="k">def</span> <span class="nf">convertTIFtoMesh</span><span class="p">(</span><span class="n">tifFile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">latSampling</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inferSampling</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">lonSampling</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">planet</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">lon0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lon1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Convert a TIF map of emissivities to the format needed for assigning values to each face of a planetary 3D mesh</span>

<span class="sd">	Parameters:</span>
<span class="sd">	tifFile : [str] the path to the TIFF file</span>
<span class="sd">	latSampling: [float, in rad] sampling step of latitude</span>
<span class="sd">	lonSampling: [float, in rad] sampling step of longitude</span>
<span class="sd">	planet: [class.Planet] Planet object containing the mesh and the planetary frames</span>
<span class="sd">	inferSampling: [bool] wether the importer shall infer the sampling or not</span>
<span class="sd">	Returns:</span>
<span class="sd">	emissivityInterpolator: [class.LookupTableND] an interpolator for mapping the temperatures on the mesh faces. This is intended to be passed</span>
<span class="sd">				to the Planet class via the setter method: Planet.emissivity = emissivityInterpolator</span>

<span class="sd">	&quot;&quot;&quot;</span>


	<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tifFile</span><span class="p">)</span>
	
	<span class="c1">#arr = np.expand_dims(np.array(im), axis = 2)</span>
	<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

	<span class="c1">#import matplotlib.pyplot as plt</span>
	<span class="c1">#plt.figure()</span>
	<span class="c1">#print(np.array(im).shape)</span>
	<span class="c1">#plt.contourf(np.array(im))</span>

	<span class="k">if</span> <span class="n">inferSampling</span><span class="p">:</span>
		<span class="n">lonSampling</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon1</span><span class="o">-</span><span class="n">lon0</span><span class="p">)</span><span class="o">/</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">latSampling</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat1</span><span class="o">-</span><span class="n">lat0</span><span class="p">)</span><span class="o">/</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

	<span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lat0</span><span class="p">,</span> <span class="n">lat1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">((</span><span class="n">lat1</span> <span class="o">-</span> <span class="n">lat0</span><span class="p">)</span> <span class="o">/</span> <span class="n">latSampling</span> <span class="p">)))</span>
	<span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">((</span><span class="n">lon1</span> <span class="o">-</span> <span class="n">lon0</span><span class="p">)</span> <span class="o">/</span> <span class="n">lonSampling</span> <span class="p">)))</span>

	<span class="n">lut</span> <span class="o">=</span> <span class="n">TiffInterpolator</span><span class="p">(</span><span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">),</span> <span class="n">values</span> <span class="o">=</span> <span class="n">arr</span><span class="p">)</span>


	<span class="k">return</span> <span class="n">lut</span>




<span class="w">	</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	newlats = np.linspace(lat0, lat1, 1000)</span>
<span class="sd">	newlons = np.linspace(lon0, lon1, 1000)</span>
<span class="sd">	import matplotlib.pyplot as plt</span>
<span class="sd">	plt.figure()</span>
<span class="sd">	plt.plot(lats,arr[0,:,0], marker = &#39;o&#39;, label = &#39;orig&#39;)</span>
<span class="sd">	dd = lut[0, newlats]</span>
<span class="sd">	plt.plot(newlats,dd, marker = &#39;.&#39;, label = &#39;interp&#39;)</span>
<span class="sd">	plt.legend()</span>
<span class="sd">	plt.show()</span>
<span class="sd">	&#39;&#39;&#39;</span></div>



<div class="viewcode-block" id="convertEpoch"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.convertEpoch">[docs]</a><span class="k">def</span> <span class="nf">convertEpoch</span><span class="p">(</span><span class="n">monteEpoch</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Convert a Monte epoch string to a spice epoch string</span>

<span class="sd">	&#39;&#39;&#39;</span></div>


<span class="c1"># def get_spacecraft_area(spacecraft, ra = 0.0, dec = 0.0, epoch = None):</span>

<span class="c1"># 	&#39;&#39;&#39;</span>
<span class="c1"># 	Compute a pyRTX.Spacecraft apparent area as seen by the direction specified </span>
<span class="c1"># 	by a pair of right ascension - declination</span>

<span class="c1"># 	Input:</span>
<span class="c1"># 	spacecraft [pyRTX.Spacecraft] 	: the spacecraft object</span>
<span class="c1"># 	ra [float] 						: right ascension (in rad)</span>
<span class="c1"># 	dec [float] 					: declination (rad)</span>
<span class="c1"># 	epoch [float or None]			: epoch for the computation (this is used when moving Spice</span>
<span class="c1"># 										frames are used for the Spacecraft definition)</span>

<span class="c1"># 	Output:</span>
<span class="c1"># 	area [float] 					: the apparent area. The measurement units depend on the units of the</span>
<span class="c1"># 				   						Spacecraft object</span>

<span class="c1"># 	TODO: avoid hardcoded width/height but rather use an automated method</span>

<span class="c1"># 	&#39;&#39;&#39;</span>
<span class="c1"># 	from pyRTX.classes.PixelPlane import PixelPlane</span>
<span class="c1"># 	from pyRTX.classes.RayTracer  import RayTracer</span>
<span class="c1"># 	rays = PixelPlane( </span>
<span class="c1"># 			spacecraft = spacecraft,   # Spacecraft object </span>
<span class="c1"># 			mode = &#39;Fixed&#39;,   # Mode: can be &#39;Dynamic&#39; ( The sun orientation is computed from the kernels), or &#39;Fixed&#39;</span>
<span class="c1"># 			distance = 10000,	    # Distance of the ray origin from the spacecraft</span>
<span class="c1"># 			width = 10,	    # Width of the pixel plane</span>
<span class="c1"># 			height = 10,        # Height of the pixel plane</span>
<span class="c1"># 			lon = ra,</span>
<span class="c1"># 			lat = dec, </span>
<span class="c1"># 			ray_spacing = 0.01, # Ray spacing (in m)</span>
<span class="c1"># 		)</span>

<span class="c1"># 	rtx = RayTracer(        </span>
<span class="c1">#                         spacecraft,                    # Spacecraft object</span>
<span class="c1">#                         rays,                   # pixelPlane object</span>
<span class="c1">#                         kernel = &#39;Embree&#39;,      # The RTX kernel to use</span>
<span class="c1">#                         bounces = 1,            # The number of bounces to account for</span>
<span class="c1">#                         diffusion = False,       # Account for secondary diffusion</span>
<span class="c1">#                         ) </span>

<span class="c1"># 	rtx.trace(epoch)</span>
<span class="c1"># 	hit_rays = rtx.index_ray_container</span>
<span class="c1"># 	Area =  len(hit_rays[0])/rays.norm_factor</span>
<span class="c1"># 	return Area</span>



<div class="viewcode-block" id="get_spacecraft_area"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.get_spacecraft_area">[docs]</a><span class="k">def</span> <span class="nf">get_spacecraft_area</span><span class="p">(</span><span class="n">spacecraft</span><span class="p">,</span> <span class="n">rays</span><span class="p">,</span> <span class="n">ra</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">epoch</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

<span class="w">	</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Compute a pyRTX.Spacecraft apparent area as seen by the direction specified </span>
<span class="sd">	by a pair of right ascension - declination</span>

<span class="sd">	Input:</span>
<span class="sd">	spacecraft [pyRTX.Spacecraft] 	: the spacecraft object</span>
<span class="sd">	rays [pyRTX.PixelPlane]			: the pixel plane for raytracing</span>
<span class="sd">	ra [float] 						: right ascension (in rad)</span>
<span class="sd">	dec [float] 					: declination (rad)</span>
<span class="sd">	epoch [float or None]			: epoch for the computation (this is used when moving Spice</span>
<span class="sd">										frames are used for the Spacecraft definition)</span>

<span class="sd">	Output:</span>
<span class="sd">	area [float] 					: the apparent area. The measurement units depend on the units of the</span>
<span class="sd">				   						Spacecraft object</span>

<span class="sd">	TODO: avoid hardcoded width/height but rather use an automated method</span>

<span class="sd">	&#39;&#39;&#39;</span>
	<span class="kn">from</span> <span class="nn">pyRTX.classes.PixelPlane</span> <span class="kn">import</span> <span class="n">PixelPlane</span>
	<span class="kn">from</span> <span class="nn">pyRTX.classes.RayTracer</span>  <span class="kn">import</span> <span class="n">RayTracer</span>

	<span class="n">rtx</span> <span class="o">=</span> <span class="n">RayTracer</span><span class="p">(</span>        
                        <span class="n">spacecraft</span><span class="p">,</span>                    <span class="c1"># Spacecraft object</span>
                        <span class="n">rays</span><span class="p">,</span>                   <span class="c1"># pixelPlane object</span>
                        <span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;Embree3&#39;</span><span class="p">,</span>      <span class="c1"># The RTX kernel to use</span>
                        <span class="n">bounces</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>            <span class="c1"># The number of bounces to account for</span>
                        <span class="n">diffusion</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>       <span class="c1"># Account for secondary diffusion</span>
                        <span class="p">)</span> 

	<span class="n">rays</span><span class="o">.</span><span class="n">update_latlon</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">dec</span><span class="p">)</span>
	<span class="n">rtx</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>
	<span class="n">hit_rays</span> <span class="o">=</span> <span class="n">rtx</span><span class="o">.</span><span class="n">index_ray_container</span>
	<span class="n">Area</span> <span class="o">=</span>  <span class="nb">len</span><span class="p">(</span><span class="n">hit_rays</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">rays</span><span class="o">.</span><span class="n">norm_factor</span>
	<span class="k">return</span> <span class="n">Area</span></div>



<span class="c1">### ------------------------------- User-Defined functions ------------------------------ ###</span>

<span class="kn">from</span> <span class="nn">pyRTX.core.parallel_utils</span> <span class="kn">import</span> <span class="n">parallel</span>

<div class="viewcode-block" id="get_sun_exposed_area"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.get_sun_exposed_area">[docs]</a><span class="nd">@parallel</span>
<span class="k">def</span> <span class="nf">get_sun_exposed_area</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">rtx</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>

<span class="w">	</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Compute a pyRTX.Spacecraft apparent area as seen by the direction specified </span>
<span class="sd">	by a pair of right ascension - declination</span>

<span class="sd">	Input:</span>
<span class="sd">	spacecraft [pyRTX.Spacecraft] 	: the spacecraft object</span>
<span class="sd">	ra [float] 						: right ascension (in rad)</span>
<span class="sd">	dec [float] 					: declination (rad)</span>
<span class="sd">	epoch [float or None]			: epoch for the computation (this is used when moving Spice</span>
<span class="sd">										frames are used for the Spacecraft definition)</span>

<span class="sd">	Output:</span>
<span class="sd">	area [float] 					: the apparent area. The measurement units depend on the units of the</span>
<span class="sd">				   						Spacecraft object</span>

<span class="sd">	TODO: avoid hardcoded width/height but rather use an automated method</span>

<span class="sd">	&#39;&#39;&#39;</span>

	<span class="c1"># Get ra, dec of the solar direction</span>
	<span class="n">sundir</span>  <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span> <span class="s1">&#39;Sun&#39;</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">sc</span><span class="o">.</span><span class="n">base_frame</span><span class="p">,</span> <span class="s1">&#39;LT+S&#39;</span><span class="p">,</span> <span class="n">sc</span><span class="o">.</span><span class="n">name</span> <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
	<span class="n">sundir</span>  <span class="o">=</span> <span class="n">sundir</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sundir</span><span class="p">)</span>
	<span class="n">_</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">recrad</span><span class="p">(</span><span class="n">sundir</span><span class="p">)</span>

	<span class="c1"># Update the ray tracer</span>
	<span class="n">rtx</span><span class="o">.</span><span class="n">rays</span><span class="o">.</span><span class="n">update_latlon</span><span class="p">(</span><span class="n">lon</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">dec</span><span class="p">)</span>

	<span class="c1"># Get area</span>
	<span class="n">rtx</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>
	<span class="n">hit_rays</span> <span class="o">=</span> <span class="n">rtx</span><span class="o">.</span><span class="n">index_ray_container</span>
	<span class="n">Area</span> <span class="o">=</span>  <span class="nb">len</span><span class="p">(</span><span class="n">hit_rays</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">rtx</span><span class="o">.</span><span class="n">rays</span><span class="o">.</span><span class="n">norm_factor</span>
 
	<span class="k">return</span> <span class="n">Area</span></div>

<div class="viewcode-block" id="compute_body_positions"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.compute_body_positions">[docs]</a><span class="k">def</span> <span class="nf">compute_body_positions</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">abcorr</span> <span class="o">=</span> <span class="s1">&#39;LT + S&#39;</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Functions to compute the relative positions of a target</span>
<span class="sd">	body with respect to an observing body.</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-	target: target body name</span>
<span class="sd">	-	epochs: list of epochs</span>
<span class="sd">	-	frame: reference frame of output position vector</span>
<span class="sd">	-	obs: observing body name</span>
<span class="sd">	-	abcorr: aberration correction flag.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">state</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">epochs</span><span class="p">),</span> <span class="n">frame</span><span class="p">,</span> <span class="n">abcorr</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>

	<span class="k">return</span> <span class="p">[</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">epochs</span><span class="p">))]</span></div>

<div class="viewcode-block" id="compute_body_states"><a class="viewcode-back" href="../../../api/generated/pyRTX.core.analysis_utils.html#pyRTX.core.analysis_utils.compute_body_states">[docs]</a><span class="k">def</span> <span class="nf">compute_body_states</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">abcorr</span> <span class="o">=</span> <span class="s1">&#39;LT + S&#39;</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Functions to compute the relative position and velocity of a target</span>
<span class="sd">	body with respect to an observing body.</span>

<span class="sd">	Parameters:</span>
<span class="sd">	-	target: target body name</span>
<span class="sd">	-	epochs: list of epochs</span>
<span class="sd">	-	frame: reference frame of output position vector</span>
<span class="sd">	-	obs: observing body name</span>
<span class="sd">	-	abcorr: aberration correction flag.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">state</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">spkezr</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">epochs</span><span class="p">),</span> <span class="n">frame</span><span class="p">,</span> <span class="n">abcorr</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>

	<span class="k">return</span> <span class="p">[</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">][:]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">epochs</span><span class="p">))]</span></div>

<span class="c1">### ------------------------------------------------------------------------------------- ###</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Gael Cascioli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>